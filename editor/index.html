<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>kosmos-gen Editor</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div id="app">
    <nav id="tabs">
      <button class="tab active" data-tab="terrain">1. Terrain</button>
      <button class="tab" data-tab="noise">2. Noise</button>
      <button class="tab" data-tab="hydrology">3. Hydrology</button>
      <button class="tab" data-tab="climate" disabled>4. Climate</button>
      <button class="tab" data-tab="zones" disabled>5. Zones</button>
      <button class="tab" data-tab="content" disabled>6. Content</button>
    </nav>

    <main id="workspace">
      <canvas id="canvas"></canvas>
      <aside id="panel">
        <div id="properties">
          <h3>Properties</h3>
          <div id="no-selection">
            <p>Click to place blobs or select existing ones</p>

            <!-- Tool defaults shown when nothing selected -->
            <div id="tool-props">
              <h4>New Blob Settings</h4>
              <label>
                Elevation:
                <input type="range" id="tool-elevation" min="0" max="1" step="0.05" value="0.5">
                <span id="tool-elevation-value">0.50</span>
              </label>
              <label>
                Radius:
                <input type="range" id="tool-radius" min="0.05" max="1" step="0.05" value="0.25">
                <span id="tool-radius-value">0.25</span>
              </label>
              <label>
                Profile:
                <select id="tool-profile">
                  <option value="cone">Cone (linear)</option>
                  <option value="plateau">Plateau (flat top)</option>
                  <option value="bowl">Bowl (concave)</option>
                  <option value="shield">Shield (convex)</option>
                </select>
              </label>
            </div>
          </div>

          <!-- Blob properties (shown when blob selected) -->
          <div id="blob-props" style="display: none;">
            <h4>Selected Blob</h4>
            <label>
              Elevation:
              <input type="range" id="prop-elevation" min="0" max="1" step="0.05" value="0.5">
              <span id="prop-elevation-value">0.50</span>
            </label>
            <label>
              Radius:
              <input type="range" id="prop-radius" min="0.05" max="1" step="0.05" value="0.25">
              <span id="prop-radius-value">0.25</span>
            </label>
            <label>
              Profile:
              <select id="prop-profile">
                <option value="cone">Cone (linear)</option>
                <option value="plateau">Plateau (flat top)</option>
                <option value="bowl">Bowl (concave)</option>
                <option value="shield">Shield (convex)</option>
              </select>
            </label>
            <p class="hint">Shift+scroll: elevation | Ctrl+scroll: radius</p>
          </div>
        </div>

        <!-- Global Noise Settings (Tab 2 only) -->
        <div id="noise-settings" style="display: none;">
          <h3>Domain Warp</h3>
          <label class="toggle-label">
            <input type="checkbox" id="warp-enabled" checked>
            Enable Warp
          </label>
          <label>
            Warp Strength:
            <input type="range" id="warp-strength" min="0" max="0.15" step="0.005" value="0.05">
            <span id="warp-strength-value">0.05</span>
          </label>
          <label>
            Warp Scale:
            <input type="range" id="warp-scale" min="0.005" max="0.05" step="0.005" value="0.015">
            <span id="warp-scale-value">0.015</span>
          </label>

          <h3>Surface Noise</h3>
          <label>
            Roughness:
            <input type="range" id="default-roughness" min="0" max="1" step="0.05" value="0.3">
            <span id="default-roughness-value">0.30</span>
          </label>
          <label>
            Feature Scale:
            <input type="range" id="default-feature-scale" min="0.05" max="0.5" step="0.05" value="0.2">
            <span id="default-feature-scale-value">0.20</span>
          </label>

          <h3>Micro Detail</h3>
          <label class="toggle-label">
            <input type="checkbox" id="micro-detail-enabled" checked>
            Enable Micro Detail
          </label>
          <label>
            Amplitude:
            <input type="range" id="micro-detail-amplitude" min="0" max="0.05" step="0.005" value="0.02">
            <span id="micro-detail-amplitude-value">0.020</span>
          </label>
        </div>

        <!-- Hydrology Settings (Tab 3 only) -->
        <div id="hydrology-settings" style="display: none;">
          <h3>Global Settings</h3>
          <label class="toggle-label">
            <input type="checkbox" id="auto-detect-sources">
            Auto-detect Sources
          </label>
          <label class="toggle-label">
            <input type="checkbox" id="river-carving" checked>
            River Carving
          </label>

          <h3>River Parameters</h3>
          <label>
            River Threshold:
            <input type="range" id="river-threshold" min="10" max="200" step="10" value="50">
            <span id="river-threshold-value">50</span>
          </label>
          <label>
            River Width:
            <input type="range" id="river-width-scale" min="0.5" max="3" step="0.25" value="1">
            <span id="river-width-scale-value">1.00</span>
          </label>
          <label>
            Carve Depth:
            <input type="range" id="carve-factor" min="0" max="0.05" step="0.005" value="0.02">
            <span id="carve-factor-value">0.020</span>
          </label>

          <h3>Display Options</h3>
          <label class="toggle-label">
            <input type="checkbox" id="show-flow-grid">
            Show Flow Grid
          </label>
          <label class="toggle-label">
            <input type="checkbox" id="show-watersheds">
            Show Watersheds
          </label>
          <label class="toggle-label">
            <input type="checkbox" id="show-water-sources" checked>
            Show Water Sources
          </label>

          <button id="simulate-water" class="prop-button" style="background: #2a5a3a; border-color: #3a7a4a;">Simulate Water</button>
        </div>

        <!-- Water Source Properties (shown when source selected) -->
        <div id="source-props" style="display: none;">
          <h3>Water Source</h3>
          <label>
            Flow Rate:
            <input type="range" id="prop-source-flow" min="0.1" max="1" step="0.05" value="0.5">
            <span id="prop-source-flow-value">0.50</span>
          </label>
          <label class="toggle-label">
            <input type="checkbox" id="prop-source-enabled" checked>
            Enabled
          </label>
          <button id="delete-source" class="prop-button danger">Delete Source</button>
        </div>

        <!-- Lake Properties (shown when lake selected) -->
        <div id="lake-props" style="display: none;">
          <h3>Lake</h3>
          <label>
            Water Level:
            <input type="range" id="prop-lake-level" min="0.1" max="0.5" step="0.01" value="0.15">
            <span id="prop-lake-level-value">0.15</span>
          </label>
          <p id="lake-type-label">Type: <span id="prop-lake-type">Endorheic</span></p>
          <button id="delete-lake" class="prop-button danger">Delete Lake</button>
        </div>
      </aside>
    </main>

    <footer id="toolbar">
      <div id="tools">
        <button id="tool-select" class="tool active" title="Select blobs (drag center to move, drag edge to resize)">
          <span class="icon">&#x2B1C;</span> Select
        </button>
        <button id="tool-add" class="tool" title="Add blob (click to place, inherits last settings)">
          <span class="icon">+</span> Add
        </button>
        <button id="tool-delete" class="tool" title="Delete blob (click on blob to remove)">
          <span class="icon">&#x2715;</span> Delete
        </button>
        <!-- Hydrology tools (Tab 3 only) -->
        <button id="tool-add-source" class="tool hydrology-tool" title="Add water source" style="display: none;">
          <span class="icon">&#x1F4A7;</span> Source
        </button>
        <button id="tool-add-lake" class="tool hydrology-tool" title="Add lake marker" style="display: none;">
          <span class="icon">&#x1F30A;</span> Lake
        </button>
        <span class="tool-separator"></span>
        <button id="clear-canvas" class="tool-action" title="Clear all blobs">
          <span class="icon">&#x1F5D1;</span> Clear
        </button>
      </div>
      <div id="view-controls">
        <label><input type="checkbox" id="show-elevation" checked> Elevation</label>
        <label><input type="checkbox" id="show-contours"> Contours</label>
        <label><input type="checkbox" id="show-cells" checked> Cells</label>
        <label>Seed: <input type="number" id="seed" value="42"></label>
        <button id="randomize">&#x1F3B2;</button>
      </div>
    </footer>
  </div>

  <script type="module" src="app.js"></script>
</body>
</html>
